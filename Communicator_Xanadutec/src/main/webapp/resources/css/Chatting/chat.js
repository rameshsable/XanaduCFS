$().ready(function(){$answers=$('ul#answersContainer');$('#starButton').click(function(){$this=$(this);if(sitecode=='otomotopl'||sitecode=='autovitro'){var selected=$this.find('#starStatus').hasClass('icon-observe_Active')?1:0}else if(sitecode=='otodompl'){var selected=$this.hasClass('icon-star-filled')?1:0}else var selected=$this.find('.icon').hasClass('selected')?1:0;var id=$this.data("id");$.post(www_base+'/ajax/myaccount/star/',{selected:selected?0:1,id:id},function(data){if(typeof data!=='undefined'&&data!==null&&data.error==1){ShowMessage.error(data.message);return false};if(sitecode=='otomotopl'||sitecode=='autovitro'){if(selected){$this.find('#starStatus').removeClass('icon-observe_Active').addClass('icon-observe_Inactive');$this.find('#starText').text('Mark with star')}else{$this.find('#starStatus').removeClass('icon-observe_Inactive').addClass('icon-observe_Active');$this.find('#starText').text('Remove star')}}else if(sitecode=='otodompl'){if(selected){$this.removeClass('icon-star-filled').addClass('icon-star');$this.text('Mark with star')}else{$this.removeClass('icon-star').addClass('icon-star-filled');$this.text('Remove star')}}else if(selected){$this.find('.icon').removeClass('selected');$this.find('.link span').text('Mark with star')}else{$this.find('.icon').addClass('selected');$this.find('.link span').text('Remove star')}});return false});$('#activatemessage').click(function(){$this=$(this);var id=$this.data("id");$.post(www_base+'/ajax/myaccount/activatemessage/?setFlashMessage=1',{messageID:id},function(){window.location=www_base+'/myaccount/answers/archive'});return false});$('#deactivatemessage').click(function(){$this=$(this);var id=$this.data("id");$.post(www_base+'/ajax/myaccount/removemessage/',{messageID:id},function(data){if(typeof data!=='undefined'&&data!==null&&data.error==1){ShowMessage.error(data.message);return false};$this.addClass('hidden');$('#activatemessage').removeClass('hidden');$('#removemessage').removeClass('hidden')});return false});$('#archiveMessage').click(function(){$this=$(this);var id=$this.data("id");$.post(www_base+'/ajax/myaccount/removemessage/',{messageID:id},function(data){if(typeof data!=='undefined'&&data!==null&&data.error==1){ShowMessage.error(data.message);return false};if(sitecode=='otodompl'){$this.addClass('hidden');$('#starButton').addClass('hidden')}else $this.addClass('hidden').siblings('#starButton').addClass('hidden');$('#activatemessage').removeClass('hidden');$('#removemessage').removeClass('hidden');ShowMessage.showMsg('Archived successfully','success')});return false});if(sitecode!='otodompl'&&sitecode!='otomotopl'&&sitecode!='autovitro'){$('.userBlock',$answers).fancybox({showCloseButton:false,onStart:function(){$('#blockUser').show()},height:'auto',width:'400',onClosed:function(){$('#blockUser').hide()}})}else $('.userBlock',$answers).on('click',function(e){$('#blockUser').modal('show')});var $bankDiv=$('#carefulDiv');if($bankDiv.length)$.fancybox({href:'#carefulDiv',title:'<p class="block clr xx-large lheight22">Be careful</p>',titleShow:true,scrolling:'no',autoScale:false,autoDimensions:true,onStart:function(){$('#fancybox-outer').addClass('fancyboxCareful');var innerHeight=$(window).height()-300;$('#carefulInnerHeight').css({maxHeight:innerHeight,overflow:"auto"});$('#bankWarningCancel').click(function(){$.post(www_base+'/ajax/myaccount/hidebankwarning/');$.fancybox.close();return false});$('#bankConfirmCancel').click(function(){$.fancybox.close();return false})},onCleanup:function(){$('#carefulDiv').unwrap()},onClosed:function(){$('#fancybox-outer').removeClass('fancyboxCareful')}});var $response=$('#response');if($response.val()=='')$response.addClass('c83').val($response.attr('defval'));$response.focus(function(){var $this=$(this);if($this.val()==$this.attr('defval'))$this.removeClass('c83').val('')}).blur(function(){var $this=$(this);if($this.val()=='')$this.addClass('c83').val($this.attr('defval'))});$('#submitBlockade').click(function(){blocked=$(this).data("opposite_user");currently=$('#opposite_blocked').val();currently=parseInt(currently);$.post(www_base+'/ajax/myaccount/blockuser/',{blocked:blocked,value:currently?0:1,messageId:$('#header_id').val()},function(response){if(sitecode!='otodompl'&&sitecode!='otomotopl'&&sitecode!='autovitro'){if(currently){$('.userBlock span.hvline').html('Block user');$('#blockUserTopic').html('Block user');$('#blockUserMsg').html('If you do not want to receive messages from this user, select Block user. You will be able to restore the ability to receive messages from this user by clicking Unblock user.');$('#blockButton').html('Block user')}else{$('.userBlock span.hvline').html('Unblock user');$('#blockUserTopic').html('Unblock user');$('#blockUserMsg').html('This user is blocked, so you will not receive any messages from him. If you want to restore your ability to receive messages from that user select Unblock.');$('#blockButton').html('Unblock user')}}else{$('#blockUser').modal('hide');if(currently){$('a.userBlock span').html('Block user');$('#myModalLabel').html('Block user');$('#blockUserMsg').html('If you do not want to receive messages from this user, select Block user. You will be able to restore the ability to receive messages from this user by clicking Unblock user.');$('#blockButton').html('Block user')}else{$('a.userBlock span').html('Unblock user');$('#myModalLabel').html('Unblock user');$('#blockUserMsg').html('This user is blocked, so you will not receive any messages from him. If you want to restore your ability to receive messages from that user select Unblock.');$('#blockButton').html('Unblock user')}};$('#opposite_blocked').val(currently?0:1);if(sitecode!='otodompl'&&sitecode!='otomotopl'&&sitecode!='autovitro')$.fancybox.close()});return false});$('#cancelBlockade').click(function(){if(sitecode!='otodompl'&&sitecode!='otomotopl'&&sitecode!='autovitro'){$('#blockUser').hide();$.fancybox.close()}else $('#blockUser').modal('hide');return false});$('#uploading').click(function(){$('#upload-div:hidden').show().children('.upload-inputs:hidden:first').show();if(Main.isIOS()&&Main.getIOSVersion()<6)$('#safariWarning').show();return false});$('input.attachment').change(function(){var $this=$(this);if($this.val()){$this.parents('.upload-inputs').next().show();var $li=$this.closest('.upload-inputs');$('p.attachment:hidden',$li).eq(0).show();$this.next().show()}}).eq(-2).change(function(){$('#uploading').hide()});$('input.removeAtachment').click(function(){var $this=$(this),$fileInput=$this.prev('input[type=file]');$fileInput.val('').replaceWith($fileInput.clone(true));$this.hide()});$('#submitAnswer').click(function(){if($response.val()==$response.attr('defval'))$response.removeClass('c83').val('')});$form=$('#formMyAnswer');$formErrorBox=$('#ErrorBox');if($form.length)$form.validate({rules:{msg:{required:true,maxlength:5e3}},errorPlacement:function(error,element){$formErrorBox.show().find('p.error').html(error)},highlight:function(element,errorClass,validClass){$formErrorBox.show()},unhighlight:function(element,errorClass,validClass){$formErrorBox.hide()},submitHandler:function(form){var sendAjax=true;$('#submitAnswer').attr('disabled','disabled');if($response.val()==$response.attr('defval'))$response.removeClass('c83').val('');$('.attachment').each(function(){if($(this).val()){form.submit();sendAjax=false;return false}});if($('#riak_key').length){form.submit();return false};var id=$('#answerMenu').data("id");msg=$response.val();if(sendAjax)$.post(www_base+'/ajax/myaccount/addanswer/',{msg:msg,id:id},function(response){if(typeof response!=='undefined'&&response!==null&&response.error==1){ShowMessage.error(response.message)}else{var $tpl=$('#answer-tpl').clone().removeAttr('id');$tpl.find('.dateAgo').text(response.date);$tpl.find('.answerText').html(new String(msg).replace(new RegExp("\n",'g'),'<br>'));if(sitecode=='otodompl'){$tpl.insertBefore($('#answer-tpl')).fadeIn('fast')}else $tpl.insertBefore($('#answerForm')).fadeIn('fast');$response.val('');$('#submitAnswer').removeAttr('disabled');$response.val($response.attr('defval')).addClass('c83');$('.errorbox:visible').fadeOut();if(typeof sitecode!='undefined'&&(sitecode=='olxpl'||sitecode=='olxro')){var $appsOverlay=$('#layer-apps'),closeLayerApps=function(){$appsOverlay.find('.layer-content').fadeOut(200,function(){$appsOverlay.fadeOut(100)});$.cookie('layerappsSeen','1',{expires:30,path:'/',domain:'.'+session_domain})};if($.cookie('layerappsSeen')==null)setTimeout(function(){$appsOverlay.fadeIn()},1e3);$('.layerapps-close',$appsOverlay).click(function(e){e.preventDefault();closeLayerApps()});$(document).keyup(function(e){if(e.keyCode==27)closeLayerApps()})}}});return false}}).showErrorsFromAction();var $answerMenu=$('#answerMenu'),answerMenuTop=$answerMenu.offset().top,answerMenuWidth=$answerMenu.width(),answerMenuHeight=$answerMenu.outerHeight(true),moduleNewlook=$('body').hasClass('newlook');if(window.sitecode!='otodompl'&&window.sitecode!='otomotopl'&&window.sitecode!='autovitro'){$answerMenu.wrap('<div class="fixedContainer"></div>');var $answerMenuContainer=$answerMenu.parent('.fixedContainer');$answerMenuContainer.css('height',answerMenuHeight);$(window).resize(function(){var answerMenuLeft=$answerMenuContainer.offset().left;$answerMenu.css({left:answerMenuLeft})}).resize();$(window).scroll(function(event){var answerMenuY=$(this).scrollTop();if(answerMenuY+(!moduleNewlook?+10:-10)>=answerMenuTop){$answerMenu.addClass('fix').css({top:0,width:answerMenuWidth})}else $answerMenu.removeClass('fix').css({top:0,width:answerMenuWidth})}).scroll()};setTimeout(function(){if(window.location.hash){if(navigator.appName=="Microsoft Internet Explorer"&&navigator.appVersion.indexOf("MSIE 9.0")!=-1&&window.location.hash=='#last')window.scrollTo(0,$('#last').position().top+240);window.scrollBy(0,-88)}},250);setTimeout(function(){if($bankDiv.length)$.fancybox.center()},350)});ValidatorsClass=BaseClass.extend({initValidators:function(params){var thiz=this;if(this.$form){var defaultParams={ignore:'.do-not-validate',rules:{'data[title]':{required:true,maxlength:70,minlength:15,noemail:true,nowww:true,nophone:true,seekingintitle:true,nocapslock:true},'data[description]':{required:true,maxlength:4096,minlength:20,noemail:true,nophone:true,nocapslock:true,nowww:false},'data[region_id]':{required:true},'data[subregion_id]':{required:true},'data[person]':{required:true,maxlength:50,minlength:2,noemail:true,nowww:true,nophone:true,person:true,nocapslock:true},'data[email]':{required:{depends:function(e){if(thiz.isModuleActive('phone_login'))return $('#phone_login_adding_attribute').val()=='email_phone'&&!$('#add-sms').val();return thiz.isEmailValidationRequired()}},email:{depends:function(e){return thiz.isEmailValidationRequired()}},maxlength:254,contactform:true},'data[sms_phone]':{required:{depends:function(e){if(thiz.isModuleActive('phone_login'))return $('#phone_login_adding_attribute').val()=='phone'||!$('#add-email').val();return false}},cellphone:true},'data[accept]':{required:true},'data[rules_schibsted]':{required:true},'data[private_business]':{required:function(e){return($('#private-business-div:visible').size()+$('#param-private_business:visible').size())>0}},'data[offer_seek]':{required:true},'data[category_id]':{required:true},'data[map_address]':{noemail:true,nowww:true,nophone:true,maxlength:50},'data[phone]':{noemail:true,nowww:true,phone:true,maxlength:20,required:true},'data[skype]':{required:{depends:function(e){return $(e).val().length>0}},nowww:true,skype:true,maxlength:32,minlength:5},'data[gg]':{},'data[comunicator]':{noemail:true,nowww:true,minlength:3},'data[promocode]':{equals:["","botosani","bistrita","monalisa","madalina","andra","natalia","mirela","alexandra","monica","manuela","ilinca","liliana","ariana","iuliana","teodora","andrea","mara","supermamica10","supermamica11","supermamica12","supermamica13","supermamica14","supermamica15","supermamica16","supermamica17","supermamica18","supermamica19","supermamica20","supermamica21","supermamica22","supermamica23","supermamica24","supermamica25","supermamica26","supermamica27","supermamica28","supermamica29","supermamica30","supermamica31","supermamica32","supermamica33","supermamica34","supermamica35","supermamica36","supermamica37","supermamica38","supermamica39","supermamica40","concurs"]},'data[sms_number]':{digits:true,minlength:10,maxlength:function(e){var val=$('#add-smsnumber').val();if(val&&val[0]==0){return 13}else return 12},notstartingwithzero:false}},messages:{'data[title]':{required:'Please enter a title',maxlength:'Title can\'t be longer than {0} characters',minlength:'Enter minimum 15 characters'},'data[description]':{required:'Enter Ad Description',maxlength:'Description can\'t be longer than {0} characters',minlength:'Min {0} chars required'},'data[phone]':{maxlength:'Cannot be longer than {0} chars'},'data[person]':{required:'Enter your Name',maxlength:'Cannot be longer than {0} chars',minlength:'Cannot be shorter than {0} chars'},'data[sms_phone]':{required:$('#phone_login_adding_attribute').val()=='email_phone'?'You must provide email address or phone':'You must provide a phone number'},'data[email]':{required:$('#phone_login_adding_attribute').val()=='email_phone'?'You must provide email address or phone':'Enter your Email address',email:'Email address is not valid'},'data[accept]':{required:'You have to accept Terms of use'},'data[rules_schibsted]':{required:'You have to accept Terms of use'},'data[private_business]':{required:'Select Seller Type'},'data[region_id]':{required:'Select your location'},'data[subregion_id]':{required:'Select your location'},'data[category_id]':{required:'Please select a category'},'data[offer_seek]':{required:'You must provide a type of Offer/ Seeking'},'data[gg]':{minlength:'Cannot be shorter than {0} chars',maxlength:'Cannot be longer than {0} chars',notstartingwithzero:'Please enter valid gg number'},'data[sms_number]':{digits:'Please enter only digits.'},'data[confirm_type]':{required:'Please choose account type'}}};params=$.extend(true,{},defaultParams,params||{});var validator=this.$form.validate(params);if(validator&&validator.showErrorsFromAction)validator.showErrorsFromAction()}},isEmailValidationRequired:function(){if(this.isModuleActive('phone_posting')){var emailInput=$('#add-email'),emailBlock=(emailInput.parents('#email').length)?emailInput.parents('#email'):emailInput.parents('.row-email');return!emailBlock.hasClass('hidden')&&!emailInput.prop('disabled')};return true}});$.validator.addMethod("pattern",function(value,element,param){if(!(param instanceof RegExp))param=new RegExp(param);return this.optional(element)||param.test(value)},'Invalid format');$.validator.addMethod("phone",function(value,element){if($.trim(value).length==0)return true;if(/^[0-9 \-,\+\(\)]+$/i.test(value)){var candidates=[].concat(value.split(',')||'');for(var i in candidates){var matches=candidates[i].match(/(\d+)/g);if(matches==null)return false;var number=matches.join("");if(number=='123456789')return false;if(number.length<7||number.length>14)return false};return true};return false},'Invalid phone format');$.validator.addMethod("notstartingwithzero",function(value,element,params){function check(value){if(value[0]=='0')return false;return true};return this.optional(element)||check(value)},'Please specify a valid mobile number');var URLRe=/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?|www\.(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/ig;jQuery.validator.addMethod("wwwaddress",function(value,element,param){return this.optional(element)||/^((https?:\/\/)?([-\w]+\.[-\w\.]+)+\w(:\d+)?(\/([-\w\/_\.\,]*(\?\S+)?)?)*)/i.test(value)},jQuery.validator.messages.url);$.validator.addMethod("noemail",function(value,element){function find(value){var re=/[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}/i;while((matched=re.exec(value))!=null){$.validator.messages['noemail']='Field is not valid. Emails and www addresses are not allowed'.replace('%s',matched[0])+'.';return true};var re2=/[@]/i;while((matched=re2.exec(value))!=null){$.validator.messages['noemail']='Field is not valid. Emails and www addresses are not allowed'.replace('%s',matched[0])+'.';return true};return false};return this.optional(element)||!find(value)},'Field is not valid. Emails and www addresses are not allowed');$.validator.addMethod("email",function(value,element){function checkEmail(value){if(value.search('"')<0)return/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(value);return false};return this.optional(element)||checkEmail(value)},'Email address is not valid');$.validator.addMethod("nowww",function(value,element){function find(value){if((matched=value.match(URLRe))!=null){$.validator.messages['nowww']='Field is not valid. Emails and www addresses are not allowed'.replace('%s',matched[0])+'.';return true};return false};return this.optional(element)||!find(value)},'Field is not valid. Emails and www addresses are not allowed');$.validator.addMethod("nocyrillic",function(value,element){function find(value){if(value.match(/[абвгдеёжзийклмнопрстуфхцчшщъыьэюяабвгдеёжзийклмнопрстуфхцчшщъыьэюя]/g)!=null)return true;return false};return this.optional(element)||!find(value)},'Field is not valid. Cyrillic is not allowed');$.validator.addMethod("nophone",function(value,element){function find(value){var baseRegex=new RegExp(/([0-9][0-9\(\)\-\s*]{6,11})/gi),slandoRegex=new RegExp(/([0-9][0-9\(\)\-\s*\.\,]{6,11})/gi),baseReplacePattern=/[ \(\)\-\s*]/g,slandoReplacePattern=/[ \-\.\s*]/g;value=value.replace(URLRe,' ');var re=baseRegex,replacePattern=baseReplacePattern,slando=false;while((matched=re.exec(value))!=null){if(slando){var ignorePattern=new RegExp(/([\(\)\,])/gi);if(ignorePattern.exec(value)!=null)return false};var numbers=matched[0].replace(replacePattern,'');if(numbers.length>=7&&numbers.length<=11){$.validator.messages['nophone']='Field is not valid. Phone numbers are not allowed'.replace('%s',matched[0])+'.';return true}};return false};return this.optional(element)||!find(value)},'Field is not valid. Phone numbers are not allowed');$.validator.addMethod("adult_age",function(value,element){function check(value){value=parseInt(value);return value>=18?true:false};return this.optional(element)||check(value)},'You have to be an Adult');$.validator.addMethod("alphanum",function(value,element){function check(value){return/^[a-z0-9._-]+$/i.test(value)};return this.optional(element)||check(value)},'Only characters and numbers allowed');$.validator.addMethod("subdomain",function(value,element){function check(value){return/^[a-z0-9]+$/i.test(value)};return this.optional(element)||check(value)},'Only characters and numbers allowed');$.validator.addMethod("yahooid",function(value,element){function check(value){return value.indexOf('._')==-1&&value.indexOf('_.')==-1&&value.indexOf('-')==-1&&value.indexOf('..')==-1&&value.indexOf('__')==-1&&/^[a-z0-9._-]+$/i.test(value)&&value.split('.').length<3&&!/^[0-9]/i.test(value)};return this.optional(element)||check(value)},'Invalid YahooID');$.validator.addMethod("skype",function(value,element){function check(value){return/^[:a-z0-9._@-]+$/i.test(value)};return this.optional(element)||check(value)},'Only characters allowed');$.validator.addMethod("person",function(value,element){return!(/[`~!@#$%^&*()_|+\=?;:",.<>\{\}\[\]\\\/]+/i.test(value))},'Only characters allowed');$.validator.addMethod("currency",function(value,element){function check(value){if($('[name="data[param_price][currency]"]').length)return $('[name="data[param_price][currency]"]').val()!='';return true};return this.optional(element)||check(value)},'Enter a Price');jQuery.validator.addMethod("minprice",function(value,element,params){function check(value){if(categoriesJSON[categoryID].rmoderation_minprice){var value=parseFloat(value.replace(thousands_separator,'').replace(decimal_separator,'.'));if(defaultCurrency==$('[name="data[param_price][currency]"]').val()||defaultCurrency==''){if(parseFloat(categoriesJSON[categoryID].rmoderation_minprice)>value)return false}else if($('[name="data[param_price][currency]"]').val()=='USD'){if(parseFloat(categoriesJSON[categoryID].rmoderation_minprice_USD)>value)return false}else if($('[name="data[param_price][currency]"]').val()=='EUR')if(parseFloat(categoriesJSON[categoryID].rmoderation_minprice_EUR)>value)return false};return true};return check(value)},'The price is too low');jQuery.validator.addMethod("maxprice",function(value,element,params){function check(value){if(categoriesJSON[categoryID].rmoderation_maxprice){var value=parseFloat(value.replace(thousands_separator,'').replace(decimal_separator,'.'));if(defaultCurrency==$('[name="data[param_price][currency]"]').val()||defaultCurrency==''){if(parseFloat(categoriesJSON[categoryID].rmoderation_maxprice)<value)return false}else if($('[name="data[param_price][currency]"]').val()=='USD'){if(parseFloat(categoriesJSON[categoryID].rmoderation_maxprice_USD)<value)return false}else if($('[name="data[param_price][currency]"]').val()=='EUR')if(parseFloat(categoriesJSON[categoryID].rmoderation_maxprice_EUR)<value)return false};return true};return check(value)},'The price is too high');$.validator.addMethod("seekingintitle",function(value,element){function check(value){if($('#category-container').val()!=""){var categoryID=parseInt($('#category-container').val());if(typeof seekingcategoriesSON!=='undefined'&&jQuery.inArray(categoryID,seekingcategoriesSON)<0){var title=$('#add-title').val().replace(/\s+/,' '),tokens=title.split(' ');for(i in tokens){var t=tokens[i].toLowerCase();for(j in seekingkeywordsJSON)if(seekingkeywordsJSON[j].toLowerCase)if(t==seekingkeywordsJSON[j].toLowerCase())return false}}};return true};return this.optional(element)||check(value)},'Seeking is not allowed');$.validator.addMethod('map_addres_tablica6',function(value,element){function check(){var $mapAddress=$('#mapAddress'),isFocus=$mapAddress.is(':focus'),hasCity=$('input#map-city-hidden').val()!=''&&$('input#map-city-hidden').val()!='undefined';return isFocus||hasCity};return this.optional(element)||check()},function(){return'Type pincode or city name and select from list'});$.validator.addMethod('map_addres_contact_tablica6',function(value,element){function check(){var $mapAddress=$('#formContactDataFormCity'),isFocus=$mapAddress.is(':focus'),hasCity=$('#contact-city-hidden').val()!=''&&$('#contact-city-hidden').val()!='undefined';return isFocus||hasCity};return this.optional(element)||check()},function(){return'Type pincode or city name and select from list'});$.validator.addMethod("contactform",function(value,element){function check(){if(window.module_phone_login)return true;if(!$('#add-mail-resposne').is(':checked'))return true;var otherForm=false;$('#add-phone, #add-gg, #add-skype').each(function(){var val=$.trim($(this).val());if(val)otherForm|=true});return otherForm};return this.optional(element)||check()},'Provide other contact method');$.validator.addMethod('nocapslock',function(value,element){var total=value.length,splitted=value.split(''),capital=$.grep(splitted,function(c){return c.toLowerCase()!=c}),percent=total>0?(100*capital.length)/total:0;return this.optional(element)||percent<50},'Too many Capital letters');$.validator.addMethod('indiaprice',function(value,element){var expr='^(?:\\d{1,2}\\'+thousands_separator+'(?:\\d{2}\\'+thousands_separator+')*\\d{3}(?:\\'+decimal_separator+'\\d{1,2})?|\\d+(?:\\'+decimal_separator+'\\d{1,2})?)$';return this.optional(element)||(new RegExp(expr).test(value.split(' ').join(''))&&parseFloat(value.replace(thousands_separator,'').replace(decimal_separator,'.'))>0&&value.replace(/\..*/,'').replace(/[\.\,]*/g,'').length<=11)},'Please enter valid price. Ex: 23'+(thousands_separator==' '?'&nbsp;':thousands_separator)+'123'+decimal_separator+'33');$.validator.addMethod('price',function(value,element){if(window.namespace!==undefined&&window.namespace=='i2')value=value.replace('.',decimal_separator);value=value.replace(new RegExp(thousands_separator,'g'),'');var expr='^(?:\\d{1,3}\\'+thousands_separator+'(?:\\d{3}\\'+thousands_separator+')*\\d{3}(?:\\'+decimal_separator+'\\d{1,2})?|\\d+(?:\\'+decimal_separator+'\\d{1,2})?)$';if($("input[name='data[param_price][0]'][value='free']").length){return this.optional(element)||(new RegExp(expr).test(value.split(' ').join(''))&&parseFloat(value.replace(thousands_separator,'').replace(decimal_separator,'.'))>=0)}else return this.optional(element)||(new RegExp(expr).test(value.split(' ').join(''))&&parseFloat(value.replace(thousands_separator,'').replace(decimal_separator,'.'))>0)},'Please enter valid price. Ex: 23'+(thousands_separator==' '?'&nbsp;':thousands_separator)+'123'+decimal_separator+'33');$.validator.addMethod('priceInt',function(value,element){var expr='^[1-9][0-9]*$';if($("input[name='data[param_price][0]'][value='free']").length){return this.optional(element)||(new RegExp(expr).test(value)>=0)}else return this.optional(element)||(new RegExp(expr).test(value.replace(/\s{1,}/g,''))>0)},'Please enter valid price. Ex: 23');$.validator.addMethod('priceIntHu',function(value,element){var expr='^[1-9][0-9]*$';if($("input[name='data[param_price][0]'][value='free']").length){return this.optional(element)||(new RegExp(expr).test(value)>0)}else return this.optional(element)||(new RegExp(expr).test(value.replace(/\s{1,}/g,''))>0)},'Please only use numbers when setting the price!');$.validator.addMethod("isnip",function(value,element){function check(nip){nip+='';nip=nip.replace(/[^0-9]+/g,'');if(nip.length<10)return false;if(nip.length>10)return false;var controlSum=0;controlSum+=parseInt(nip.charAt(0))*6;controlSum+=parseInt(nip.charAt(1))*5;controlSum+=parseInt(nip.charAt(2))*7;controlSum+=parseInt(nip.charAt(3))*2;controlSum+=parseInt(nip.charAt(4))*3;controlSum+=parseInt(nip.charAt(5))*4;controlSum+=parseInt(nip.charAt(6))*5;controlSum+=parseInt(nip.charAt(7))*6;controlSum+=parseInt(nip.charAt(8))*7;if((controlSum%11)==parseInt(nip.charAt(9))){return true}else return false};return this.optional(element)||check(value)},'Invalid nip format');$.validator.addMethod("withoutSpecialChars",function(value,element){function check(value){value+="";var chars='!#$%^*()_+=<>[]{}\'"\\/`~|'.split('');for(var i=0;i<chars.length;i++)if(value.indexOf(chars[i])!==-1)return false;return true};return this.optional(element)||check(value)},'Special chars not allowed');$.validator.addMethod("maxlengthWithoutSpaces",function(value,element,param){function check(value){var formattedValue=value.replace(/\s/g,'');if(formattedValue.length>param)return false;return true};return this.optional(element)||check(value)},'Cannot be longer than {0} chars');$.validator.addMethod('withoutSelectedChars',function(value,element,chars){function check(value,pattern){value+="";var chars=pattern.split('');for(var i=0;i<chars.length;i++)if(value.indexOf(chars[i])!==-1)return false;return true};return this.optional(element)||check(value,chars)},'Special chars not allowed');$.validator.addMethod('withoutDots',function(value,element){function check(value){value+="";return value.indexOf('.')===-1};return this.optional(element)||check(value)},'This field cannot contain dots.');$.validator.addMethod('withoutNumbers',function(value,element){value+="";return this.optional(element)||!/[0-9]/.test(value)},'This field cannot contains numbers.');$.validator.addMethod("notDefault",function(value,element,param){if(!this.depend(param,element))return"dependency-mismatch";return element.value&&element.value!=$(element).attr('defaultval')},'This field is required.');$.validator.addMethod('equalTo',function(value,element,param){return $(element).val()==$(param).val()},'Passwords should be same');$.validator.addMethod("equals",function(value,element,string){return $.inArray(value.toLowerCase(),string)!==-1},'The string you provided does not fit');$.validator.addMethod('unsignedInt',function(value,element,param){return this.optional(element)||/^[0-9]+$/.test(value)},'Invalid unsigned integer value');$.validator.addMethod('digits',function(value,element){newValue=parseFloat(value.replace(new RegExp(thousands_separator,"g"),'').replace(decimal_separator,''));if(!this.optional(element)&&!isNaN(newValue)&&newValue!=value)$(element).val(newValue);return this.optional(element)||/^\d+$/.test(newValue)},'Please enter only digits.');(function(){function check(elA,elB){var $elA=$(elA),$elB=$(elB);if($elA.length==0||$elB.length==0)return true;var a=$elA.val(),b=$elB.val();return/^[0-9]{2}$/.test(a)&&/^[0-9]{3}$/.test(b)&&!(a==='00'&&b==='000')};$.validator.addMethod("postcodeA",function(value,element){return this.optional(element)||check(element,$(element).attr('data-postcode-b'))},'Invalid postcode format.');$.validator.addMethod("postcodeB",function(value,element){return this.optional(element)||check($(element).attr('data-postcode-a'),element)},'Invalid postcode format.')})();$.validator.addMethod("isregon",function(value,element){function check(regon){regon+='';regon=regon.replace(/[^0-9]+/g,'');if(regon.length!=9&&regon.length!=14)return false;var regonLength=regon.length,digitsWeight=[];digitsWeight[9]=[8,9,2,3,4,5,6,7];digitsWeight[14]=[2,4,8,5,0,9,7,3,6,1,2,4,8];var controlSum=0;for(var i=0;i<regonLength-1;i++)controlSum+=(regon.charAt(i)*1)*digitsWeight[regonLength][i];var controlMod=(controlSum%11),controlDig=(controlMod==10)?0:controlMod;return(controlDig==(regon.charAt(regonLength-1)*1))};return this.optional(element)||check(value)},'Invalid regon format');$.validator.addMethod("postcodePL",function(value,element){function check(value){return/^[0-9]{2}-[0-9]{3}$/i.test(value)};return this.optional(element)||check(value)},'Invalid postcode format.');(function($){$.each($.validator.methods,function(key,value){$.validator.methods[key]=function(){if(arguments.length>0)arguments[0]=$.trim(arguments[0]);return value.apply(this,arguments)}})}(jQuery));jQuery.validator.addMethod("minpricesa",function(value,element,params){function check(value){if(categoriesJSON[categoryID].rmoderation_minprice){var find=thousands_separator,re=new RegExp(find,'g'),value=parseFloat(value.replace(re,'').replace(decimal_separator,'.'));if(parseFloat(categoriesJSON[categoryID].rmoderation_minprice)>value)return false};return true};return check(value)},'The price is too low');jQuery.validator.addMethod("maxpricesa",function(value,element,params){function check(value){if(categoriesJSON[categoryID].rmoderation_maxprice){var find=thousands_separator,re=new RegExp(find,'g'),value=parseFloat(value.replace(re,'').replace(decimal_separator,'.'));if(parseFloat(categoriesJSON[categoryID].rmoderation_maxprice)<value)return false};return true};return check(value)},'The price is too high')
function formatIndiaNumber(number){x=number.toString();var lastThree=x.substring(x.length-3),otherNumbers=x.substring(0,x.length-3);if(otherNumbers!='')lastThree=','+lastThree;return otherNumbers.replace(/\B(?=(\d{2})+(?!\d))/g,",")+lastThree};$.validator.addMethod('map_addres_tablica6',function(value,element){function check(){var $mapAddress=$('#mapAddress'),isFocus=$mapAddress.is(':focus'),hasCity=$('input#map-city-hidden').val()!=''&&$('input#map-city-hidden').val()!='undefined';return isFocus||hasCity};return this.optional(element)||check()},function(){return'Type your city name and select the matching city from the list.'});$.validator.addMethod("phone",function(value,element){if($.trim(value).length==0)return true;if(/^[0-9 \-,\+\(\)]+$/i.test(value)){if(/^0[0-9]*$/.test(value))return false;var candidates=[].concat(value.split(',')||'');for(var i in candidates){var matches=candidates[i].match(/(\d+)/g);if(matches==null)return false;var number=matches.join("");if(number=='1234567890')return false;if(number.length!=10)return false};return true};return false},'Invalid phone number');var NpsClass=Class.extend({init:function(config){this.config=config;this.config.isFancyBox=(this.config.isFancyBox!==undefined)?this.config.isFancyBox:true;if(config&&config.adID)this.showNPSFeedbackDialog();this.config.callback=(this.config.callback!==undefined)?this.config.callback:function(){setTimeout(function(){window.location='/myaccount/'},1e3)};this.initSubmit()},showNPSFeedbackDialog:function(){if(($('#npsFeedbackDiv').length===1)&&(this.config.isFancyBox===true))return;var thiz=this,$reasontextarea,npsInvokedFrom=this.config.npsInvokedFrom?this.config.npsInvokedFrom:'',adID=this.config.adID;if(this.config.isFancyBox)$.fancybox({href:www_base+'/ajax/nps/form/',type:'ajax',ajax:{data:{adID:adID,invoked_from:npsInvokedFrom}},width:'auto',onStart:function(){},onComplete:function(){},onClosed:function(){thiz.config.callback()},title:'<p class="marginleft15 lheight22">Feedback Form</p>',autoScale:false,autoDimensions:true})},initSubmit:function(){var thiz=this;$('#npsFeedbackDivForm').live('submit',function(){var postdata={};postdata.score=$('input[name=score]:checked').val();postdata.reason=$('#npsreason').val();postdata.adID=$('#npsfeedbackadid').val();postdata.invoked_from=$('#npsfeedbackinvokedFrom').val();if(postdata.score==null){ShowMessage.error('Please select a valid score')}else $.ajax({type:'POST',url:www_base+'/ajax/nps/',data:postdata,dataType:'json',success:function(data){ShowMessage.success(data.message);if(thiz.config.isFancyBox)$.fancybox.close();thiz.config.callback()}});return false});var $reasontextarea;$('body').on("keyup",'#npsreason',function(){if(!$reasontextarea)$reasontextarea=$('#reasonTextCount');$reasontextarea.val(this.value.length+"/75")})}});